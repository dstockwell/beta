<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="catalog-styles.html">
<link rel="import" href="catalog-list.html">
<link rel="import" href="page-loading-behavior.html">

<dom-module id="catalog-search">
  <template>
    <style include="catalog-styles"></style>

    <h1 class="page-title">[[_title(_query, title)]]</h1>

    <div id="header-main" class="main-content">
      <catalog-list id="list" query="[[_query]]" base-urls="[[baseUrls]]"></catalog-list>
    </div>

  </template>

  <script>
    Polymer({

      is: 'catalog-search',

      behaviors: [
        window.PageLoadingBehavior,
      ],

      properties: {
        baseUrls: Object,
        route: Object,
        visible: Boolean,
        author: String,
        title: {
          value: '',
          type: String,
        },
      },

      observers: [
        'pathChanged(path, visible)',
      ],

      _title: function(query, title) {
        return title ? title : 'Results for "' + query + '"';
      },

      pathChanged: function(path, visible) {
        this.loading = false;
        var disabled = !visible || this._currentPath == path;
        this.$.list.disabled = disabled;
        if (disabled)
          return;
        this._currentPath = path;
        this._query = path.substring(1);
      },

    });
  </script>
</dom-module>
